
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lotka Volterra Model in Drug Discovery</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 current">
  <a class="reference internal" href="#">
   The Lotka-Volterra Model in Drug Discovery
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kmoriarty123/lotka-volterra.git"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kmoriarty123/lotka-volterra.git/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="the-lotka-volterra-model-in-drug-discovery">
<h1>The Lotka-Volterra Model in Drug Discovery<a class="headerlink" href="#the-lotka-volterra-model-in-drug-discovery" title="Permalink to this headline">¶</a></h1>
<div class="section" id="kathleen-moriarty">
<h2>Kathleen Moriarty<a class="headerlink" href="#kathleen-moriarty" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="amidd-winter-2021">
<h2>AMIDD Winter 2021<a class="headerlink" href="#amidd-winter-2021" title="Permalink to this headline">¶</a></h2>
</div>
<div class="toctree-wrapper compound">
<span id="document-abstract"></span><div class="tex2jax_ignore mathjax_ignore section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The Lotka-Volterra Model was developed over a century again and has been used in many settings
to model interactions in ecology, banking, chemistry, and drug discovery. An introduction to equations and their
mathematical properties is provided. Then a summary of applications of the model in different drug discovery
settings is detailed. These applications include viral, …</p>
</div>
<span id="document-lotka-volterra"></span><p>The Lotka-Volterra model is a basic dynamic model named after two biomathemathicians, Alfred Lotka and Vito Volterra,
who developed the system of equations independent of each other in first half of the twentieth century.
Lotka had developed the model to explain the dynamics of predator and prey populations, expanding on his previous model
of autocatalytic chemical reactions. Volterra had developed the system of equations to model the population of predator
fish in the Adriatic Sea.</p>
<p>The system consists of two linear ordinary differential equations. One equation represents the change in population of
the prey over time and is dependent on the population of the predator. The other equation represents the same for but
for the predator population.</p>
<p>For an example, we let the prey be sheep and the predators be wolves.
If sheep were to exist without a predator and without a limitation of resources, the population would grow
exponentially:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$\frac{dx}{dt}=\alpha*x$,
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is a constant rate of growth and <span class="math notranslate nohighlight">\(x\)</span> is the sheep population.</p>
<p>If wolves were added to the environment, then the sheep population would depend on how
often they met with the wolves. If there are more wolves, then there is more likelihood that they would meet sheep and
eat one. If there are more sheep, then they would have more likelihood of meeting wolves. If a wolf eats a sheep anytime
it finds one, then the death of the sheep is proportional to how many wolves there are. This relationship is the same
as the law of mass action, the rate of the chemical reaction is proportional to the concentration of the reactants.
In this case, the death of the sheep is then represented by a constant multiplied by the populations of the sheep and
wolves. The sheep population equation becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$\frac{dx}{dt}=\alpha*x-\beta*x*y$$
</pre></div>
</div>
<p>The equation for the population of the wolves is represented by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$\frac{dy}{dt} = \delta x y - \gamma  y$,
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(y\)</span> is the wolf population, <span class="math notranslate nohighlight">\(\delta\)</span> is the growth rate of the wolves that is proportional to number of sheep and
wolves and <span class="math notranslate nohighlight">\(\gamma\)</span> is the mortality rate of the wolves.</p>
<p>There are many assumptions with this model and some of them have already been stated. Some of the assumptions are:</p>
<ul class="simple">
<li><p>The sheep population grows exponentially without the presence of wolves.</p></li>
<li><p>The wolves will always eat a sheep when it meets one.</p></li>
<li><p>The wolves only eat sheep.</p></li>
</ul>
<p>To see the interaction between the wolf and sheep populations, let alpha = 1.1, beta = 0.4, delta = 0.1, and gamma = 0.4.
If we then solve this system, assuming time is in weeks, with initial population of 10 sheep
and 1 wolf (assuming thousands), the following plot shows the solutions on the interval [0,100] (100 weeks or a little over 2 years).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span> <span class="k">as</span> <span class="n">ode</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_16268</span><span class="o">/</span><span class="mf">2820433152.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">random</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span> <span class="k">as</span> <span class="n">ode</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tabulate&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_pop</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># initial population levels [prey, predator]</span>

<span class="n">t_steps</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># time steps</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># end of time interval</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">t_steps</span><span class="p">)</span> <span class="c1"># array to store time</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="c1"># prey birthrate</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># prey death rate</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># predator birthrate</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># predator death rate</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># prey carrying capacity</span>
<span class="n">k_y</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># predator carrying capacity</span>
<span class="c1"># Array to track coefficients</span>
<span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the simulation function</span>
<span class="k">def</span> <span class="nf">run_simu</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">coef</span><span class="p">):</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Prey population value</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Predator population value</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">y</span>

    <span class="k">return</span><span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">]</span>

<span class="c1"># Call the ode solver function</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">run_simu</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">coef</span><span class="p">,))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Prey Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Predator Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population Level&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predator / Prey Dynamics&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_3_0.png" src="_images/lotka-volterra_3_0.png" />
</div>
</div>
<p>It makes sense that we see oscillations in the populations like this because we have negative
feedback - as sheep increase, wolves increase and as wolves increase, sheep decrease.
The plot shows that as the predator population approaches its maximum, the prey population decreases rapidly. Then
after the predator population has decreased, the prey population begins to increase and eventually the predator population
will begin to increase again.</p>
<p>The steady state of the model is when there is equilibrium between the populations.</p>
<p>To find the steady state we need to find the equilibrium points.
In other words, we want to know when the rate of change (derivative) is equal to zero.</p>
<p>The not-so-meaningful solution is when the prey and the predator populations are zero.</p>
<p>The more meaningful populations can be solved:</p>
<blockquote>
<div><p>\begin{align}
0 &amp;= \alpha  x - \beta x  y \
0 &amp;= x ( \alpha - \beta  y ) \
y &amp;= \frac{\alpha}{\beta} \text{ or }x = 0
\end{align}</p>
</div></blockquote>
<blockquote>
<div><p>\begin{align}
0 &amp;= \delta x y - \gamma  y \
0 &amp;= y ( \delta x - \gamma ) \
x &amp;= \frac{\gamma}{\delta} \text{ or }y = 0
\end{align}</p>
</div></blockquote>
<p>The non-zero equilibrium point for this system is <span class="math notranslate nohighlight">\( (\frac{\gamma}{\delta}, \frac{\alpha}{\beta}) \)</span></p>
<p>If we change our birth and death rate parameters to visualize this, we see that it is in fact equilibrium state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_eq</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="c1"># prey birthrate</span>
<span class="n">beta_eq</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="c1"># prey death rate</span>
<span class="n">delta_eq</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># predator birthrate</span>
<span class="n">gamma_eq</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># predator death rate</span>

<span class="c1"># Array to track coefficients</span>
<span class="n">coef_eq</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha_eq</span><span class="p">,</span> <span class="n">beta_eq</span><span class="p">,</span> <span class="n">delta_eq</span><span class="p">,</span> <span class="n">gamma_eq</span><span class="p">]</span>

<span class="c1"># Call the ode solver function</span>
<span class="n">output_eq</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">run_simu</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">coef_eq</span><span class="p">,))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output_eq</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Prey Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output_eq</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Predator Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population Level&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predator / Prey Dynamics&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_6_0.png" src="_images/lotka-volterra_6_0.png" />
</div>
</div>
<p>It would be interesting to see how the change in the parameters will change the dynamics of the populations.
To visualize, we can make a phase space plot with varying parameter values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_range_ode</span><span class="p">(</span><span class="n">lrange</span><span class="p">,</span> <span class="n">urange</span><span class="p">,</span> <span class="n">run_simu</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">coef_base</span><span class="p">):</span>

    <span class="n">output_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_steps</span><span class="p">,</span><span class="mi">2</span><span class="p">))]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># index to track output array storage</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
    <span class="c1">#for i in range(len(coef_base)):</span>
        <span class="n">coef_new</span> <span class="o">=</span> <span class="n">coef_base</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="n">lrange</span><span class="p">,</span><span class="n">urange</span><span class="p">]:</span>
            <span class="n">coef_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">coef_base</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">output_temp</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">run_simu</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">coef_new</span><span class="p">,))</span>
            <span class="n">output_range</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_temp</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">output_range</span>

<span class="n">output_vary</span> <span class="o">=</span> <span class="n">run_range_ode</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">run_simu</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># original parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;a: 1.1, b: 0.4, d:0.1, g: 0.4&quot;</span><span class="p">)</span>

<span class="c1"># alpha changes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_vary</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_vary</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;mediumvioletred&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;alpha: 0.9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_vary</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_vary</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;hotpink&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;alpha: 1.3&quot;</span><span class="p">)</span>

<span class="c1"># beta changes</span>
<span class="c1">#plt.plot(output_vary[2][:,0], output_vary[2][:,1], color = &quot;gold&quot;, label = &quot;beta: 0.2&quot;)</span>
<span class="c1">#plt.plot(output_vary[3][:,0], output_vary[3][:,1], color = &quot;goldenrod&quot;, label = &quot;beta: 0.8&quot;)</span>

<span class="c1"># delta changes</span>
<span class="c1">#plt.plot(output_vary[4][:,0], output_vary[4][:,1], color = &quot;springgreen&quot;, label = &quot;delta: 0.05&quot;)</span>
<span class="c1">#plt.plot(output_vary[5][:,0], output_vary[5][:,1], color = &quot;green&quot;, label = &quot;delta: 0.2&quot;)</span>

<span class="c1"># gamma changes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_vary</span><span class="p">[</span><span class="mi">6</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_vary</span><span class="p">[</span><span class="mi">6</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;aqua&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;gamma: 0.2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_vary</span><span class="p">[</span><span class="mi">7</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_vary</span><span class="p">[</span><span class="mi">7</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;gamma: 0.8&quot;</span><span class="p">)</span>

<span class="c1">#plt.plot(output)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Prey Population&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Predator Population&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predator / Prey Phase Space Plot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_9_0.png" src="_images/lotka-volterra_9_0.png" />
</div>
</div>
<p>The black line is the phase plot with the original parameters. It is a closed orbit that oscillates around the
fixed point <span class="math notranslate nohighlight">\( (\frac{\gamma}{\delta}, \frac{\alpha}{\beta}) = (4, 2.75) \)</span>.</p>
<p>When keeping all other parameters constant and changing only alpha, the ellipse would stretch or shrink vertically and
changing only gamma, the ellipse would stretch or shrink horizontally.</p>
<p>The assumption that the prey grow exponentially in the absence of
predators is not realistic.
A more realistic approach is to assume there is a carrying capacity.</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( \frac{dx}{dt} = \alpha x (1-\frac{x}{K}), \)</span></p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(K\)</span> is carrying capacity.</p>
<p>Now we need to add the predators to the environment:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( \frac{dx}{dt} = \alpha x (1-\frac{x}{K}) - \beta x  y \)</span></p>
</div></blockquote>
<p>And the predator equation remains the same:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\( \frac{dy}{dt} = \delta x y - \gamma  y \)</span></p>
</div></blockquote>
<p>Using these updated ODEs, we can rerun our system and see how it the dynamics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the simulation function</span>
<span class="k">def</span> <span class="nf">run_simu_carry_cap</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">coef</span><span class="p">):</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Prey population value</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Predator population value</span>

    <span class="n">tmp_alpha</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tmp_beta</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tmp_delta</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">tmp_gamma</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">tmp_alpha</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">k</span><span class="p">))</span> <span class="o">-</span> <span class="n">tmp_beta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">tmp_delta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">tmp_gamma</span> <span class="o">*</span> <span class="n">y</span>
    <span class="c1">#dxdt = tmp_alpha * x * (1 - ((x+tmp_beta*y)/k))</span>
    <span class="c1">#dydt = tmp_delta * x * y - tmp_gamma * y</span>

    <span class="k">return</span><span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">]</span>

<span class="c1"># Call the ode solver function</span>
<span class="n">output_carry_cap</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">run_simu_carry_cap</span><span class="p">,</span> <span class="n">init_pop</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">coef</span><span class="p">,))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output_carry_cap</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Prey Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">output_carry_cap</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Predator Population&quot;</span><span class="p">)</span> <span class="c1"># Prey output</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population Level&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predator / Prey Dynamics with Prey Carrying Capacity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_12_0.png" src="_images/lotka-volterra_12_0.png" />
</div>
</div>
<p>There is still an oscillation between the predator and prey populations, but the difference between the maximum and
minimum values is decreasing. The non-zero steady state of this system has changed. Previously, it was
<span class="math notranslate nohighlight">\( (\frac{\gamma}{\delta}, \frac{\alpha}{\beta}) \)</span>, but now that has changed.</p>
<blockquote>
<div><p>\begin{align}
0 &amp;= \alpha  x (1-\frac{x}{k}) - \beta x  y
\end{align}</p>
</div></blockquote>
<p>substitute <span class="math notranslate nohighlight">\(x =\frac{\gamma}{\delta}\)</span> and solve for <span class="math notranslate nohighlight">\(y\)</span></p>
<blockquote>
<div><p>\begin{align}
0 &amp;= \alpha  \frac{\gamma}{\delta} (1-\frac{\frac{\gamma}{\delta}}{k}) - \beta\frac{\gamma}{\delta}  y \
0 &amp;= \alpha (1-\frac{\gamma}{\delta k}) - \beta  y \
y &amp;= \frac{\alpha}{\beta}(1-\frac{\gamma}{\delta k})  \
\end{align}</p>
</div></blockquote>
<p>The non-zero new steady state is <span class="math notranslate nohighlight">\((\frac{\gamma}{\delta}, \frac{\alpha}{\beta}(1-\frac{\gamma}{\delta k}))\)</span></p>
<p>With the narrowing of the prey and predator population, we know that our phase plot will spiral instead of have an
ellipse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># original parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">output_carry_cap</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_carry_cap</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;original&quot;</span><span class="p">)</span>

<span class="c1">#plt.plot(output)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Prey Population&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Predator Population&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predator / Prey  with Carrying Capacity Phase Plot&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_14_0.png" src="_images/lotka-volterra_14_0.png" />
</div>
</div>
<p>These dynamics can be proven algebraically using concepts from linear algebra (calculating the eigenvalue and
eigenvector of the Jacobian matrix).</p>
<p>To add stochastic behavior to our system, we can use an algorithm to randomly choose events
and event times from probability distributions.
We can use the Gillespie algorithm to do this.</p>
<p>We keep track of the population of the predator and prey. An event occurs when birth or death
occurs in either the prey or predator population. The propensity for each event to occur at a given
time is shown in the table below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Prey + 1&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha * x * (1 - x/k)&#39;</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;Prey - 1&#39;</span><span class="p">,</span> <span class="s1">&#39;beta * x * y&#39;</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;Predator + 1&#39;</span><span class="p">,</span> <span class="s1">&#39;delta * x * y&#39;</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;Predator - 1&#39;</span><span class="p">,</span><span class="s1">&#39;gamma * y&#39;</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Events&quot;</span><span class="p">,</span> <span class="s2">&quot;Propensity&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Events        Propensity
------------  ---------------------
Prey + 1      alpha * x * (1 - x/k)
Prey - 1      beta * x * y
Predator + 1  delta * x * y
Predator - 1  gamma * y
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial conditions</span>
<span class="c1"># Original init_pop = [10,1]. Too likely for prey/predator to die out with 10 and 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="c1"># track prey</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># track predator</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># to keep track of time</span>
<span class="n">end</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">x_all</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># track results of prey from all model runs</span>
<span class="n">y_all</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># track results of predator from all model runs</span>
<span class="n">t_all</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Keep same rates of coefficients as above</span>
<span class="c1">#alpha = 10 # prey birthrate</span>
<span class="c1">#beta = 0.1 # prey death rate</span>
<span class="c1">#delta = 0.3 # predator birthrate</span>
<span class="c1">#gamma = 30 # predator death rate</span>

<span class="c1">#k = 150</span>
<span class="c1">#k_y = 100</span>
<span class="c1">#r  = 0.05</span>
<span class="c1">#K = 100</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span> <span class="c1"># simulate the model 100 times</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># reset time to rerun</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="c1"># reset time to rerun</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># reset time to rerun</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">while</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span> <span class="c1"># keep running until last item in t is after end</span>
        <span class="c1">#current_x = x[-1]</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">k</span><span class="p">),</span>
                      <span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">delta</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">gamma</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">prop_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
        <span class="c1">#print(&quot;x: &quot;, x[-1], &quot;; y: &quot;, y[-1])</span>
        <span class="k">if</span> <span class="n">prop_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># can not divide by zero so break out of while loop</span>
            <span class="k">break</span>

        <span class="c1"># choose next time increment randomly from exponential distribution with mean = 1/prop_sum</span>
        <span class="c1">#tau = np.random.exponential(scale=1/prop_sum)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>

        <span class="c1"># add the randomly chosen tau to the current time</span>
        <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">tau</span><span class="p">)</span>

        <span class="c1"># randomly choose number to later weight with probability of events</span>
        <span class="c1"># to randomly choose which event that will occur at the next time point</span>
        <span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rand</span> <span class="o">*</span> <span class="n">prop_sum</span> <span class="o">&lt;=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="c1"># growth of prey</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">rand</span> <span class="o">*</span> <span class="n">prop_sum</span> <span class="o">&gt;</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rand</span> <span class="o">*</span> <span class="n">prop_sum</span> <span class="o">&lt;=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="c1"># death of prey</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">rand</span> <span class="o">*</span> <span class="n">prop_sum</span> <span class="o">&gt;</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rand</span> <span class="o">*</span> <span class="n">prop_sum</span> <span class="o">&lt;=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">props</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="c1"># death of predator</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">t_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># plot results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_all</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_all</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x_all</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_all</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y_all</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="c1">#plt.plot(t,y, label = &quot;predator&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/lotka-volterra_18_0.png" src="_images/lotka-volterra_18_0.png" />
</div>
</div>
<span id="document-lotka-volterra-drug-discovery"></span><p>The Lotka-Volterra Model can be applied to many dynamic population systems.</p>
<p>Often, when someone is infected with one pathogen, they are infected with others as well.</p>
<p>When pathogens develop anitmicrobial resistance, then they are competing with non-resistant strains.
<span id="id1">Dimas Martins and Gjini [<a class="reference internal" href="#id3">DMG20</a>]</span> used the Lotka-Volterra Model to predict …</p>
<p id="id2"><dl class="citation">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">DMG20</a></span></dt>
<dd><p>Afonso Dimas Martins and Erida Gjini. Modeling competitive mixtures with the lotka-volterra framework for more complex fitness assessment between strains. <em>Frontiers in microbiology</em>, 11:2132, 2020.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Kathleen Moriarty<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>